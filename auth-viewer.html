<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <title>Auth-Viewer | MKSLB 2050</title>
    <script src="https://unpkg.com/@otplib/preset-browser@latest/buffer.js"></script>
    <script src="https://unpkg.com/@otplib/preset-browser@latest/index.js"></script>
    <style>
        body { background: #0a1917; color: #00c853; font-family: 'Segoe UI', sans-serif; text-align: center; padding: 20px; margin: 0; }
        .grid { display: flex; flex-direction: column; align-items: center; gap: 15px; margin-top: 20px; }
        .card { border: 2px solid #004d40; padding: 20px; border-radius: 15px; background: #0d2522; width: 90%; max-width: 300px; box-shadow: 0 10px 20px rgba(0,0,0,0.5); }
        .code { font-size: 3.5rem; color: #ffd700; font-family: 'Courier New', monospace; margin: 10px 0; letter-spacing: 5px; font-weight: bold; }
        .name { color: white; font-size: 1rem; font-weight: bold; border-bottom: 1px solid #004d40; padding-bottom: 8px; text-transform: uppercase; }
        .timer-bar { height: 6px; background: #1a332f; margin-top: 15px; border-radius: 3px; overflow: hidden; }
        .progress { height: 100%; background: #00c853; width: 100%; transition: width 1s linear; }
    </style>
</head>
<body>
    <h2 style="margin-bottom: 0;">AUTH-VIEWER PC</h2>
    <p style="color: #aaa; font-size: 0.8rem;">(OFFLINE MODE)</p>
    
    <div class="grid">
        <div class="card">
            <div class="name">EN. MUHAMMAD AIMAN</div>
            <div id="code-aiman" class="code">------</div>
            <div class="timer-bar"><div id="bar-aiman" class="progress"></div></div>
        </div>

        <div class="card">
            <div class="name">EN. FAIZ MUFASSIR</div>
            <div id="code-faiz" class="code">------</div>
            <div class="timer-bar"><div id="bar-faiz" class="progress"></div></div>
        </div>
    </div>

    <script>
        function startGenerator() {
            const secrets = {
                aiman: "AIMAN2050SOLIDMKSLB",
                faiz: "FAIZ2050SOLIDMKSLB"
            };

            function update() {
                try {
                    // Menjana kod menggunakan library otplib yang dimuatkan
                    document.getElementById('code-aiman').innerText = window.otplib.totp.generate(secrets.aiman);
                    document.getElementById('code-faiz').innerText = window.otplib.totp.generate(secrets.faiz);

                    const epoch = Math.floor(Date.now() / 1000);
                    const progress = ((30 - (epoch % 30)) / 30) * 100;
                    document.getElementById('bar-aiman').style.width = progress + "%";
                    document.getElementById('bar-faiz').style.width = progress + "%";
                } catch (e) {
                    console.error("Menunggu library sedia...");
                }
            }

            setInterval(update, 1000);
            update();
        }

        // Memastikan library sedia sebelum menjalankan penjanaan kod
        const check = setInterval(() => {
            if (window.otplib) {
                clearInterval(check);
                startGenerator();
            }
        }, 500);
    </script>
</body>
</html>
